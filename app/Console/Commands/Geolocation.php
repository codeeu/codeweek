<?php

namespace App\Console\Commands;

use App\Event;
use Illuminate\Console\Command;

class Geolocation extends Command
{
    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $signature = 'geolocation';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Update Geolocation for events without geolocation';

    /**
     * Create a new command instance.
     *
     * @return void
     */
    public function __construct()
    {
        parent::__construct();
    }

    /**
     * Execute the console command.
     *
     * @return mixed
     */
    public function handle()
    {

        $COUNTRY_LAT_LANG = [
            'AD' => [42.50, 1.50],
            'AE' => [24.00, 54.00],
            'AF' => [33.00, 65.00],
            'AG' => [17.05, -61.80],
            'AI' => [18.22, -63.05],
            'AL' => [41.00, 20.00],
            'AM' => [40.00, 45.00],
            'AN' => [12.17, -69.00],
            'AO' => [-12.50, 18.50],
            'AQ' => [-77.85, 166.67],
            'AR' => [-34.00, -64.00],
            'AS' => [-14.32, -170.50],
            'AT' => [47.33, 13.33],
            'AU' => [-25.00, 135.00],
            'AW' => [12.50, -69.97],
            'AX' => [60.12, 19.90],
            'AZ' => [40.50, 47.50],
            'BA' => [44.25, 17.83],
            'BB' => [13.17, -59.53],
            'BD' => [24.00, 90.00],
            'BE' => [50.83, 4.00],
            'BF' => [13.00, -2.00],
            'BG' => [43.00, 25.00],
            'BH' => [26.00, 50.50],
            'BI' => [-3.50, 30.00],
            'BJ' => [9.50, 2.25],
            'BM' => [32.33, -64.75],
            'BN' => [4.50, 114.67],
            'BO' => [-17.00, -65.00],
            'BR' => [-10.00, -55.00],
            'BS' => [24.00, -76.00],
            'BT' => [27.50, 90.50],
            'BV' => [-54.43, 3.40],
            'BW' => [-22.00, 24.00],
            'BY' => [53.00, 28.00],
            'BZ' => [17.25, -88.75],
            'CA' => [60.00, -96.00],
            'CC' => [-12.17, 96.83],
            'CD' => [-3.52, 23.42],
            'CF' => [7.00, 21.00],
            'CG' => [-1.00, 15.00],
            'CH' => [47.00, 8.00],
            'CI' => [8.00, -5.00],
            'CK' => [-20.00, -158.00],
            'CL' => [-30.00, -71.00],
            'CM' => [6.00, 12.00],
            'CN' => [35.00, 105.00],
            'CO' => [4.00, -72.00],
            'CR' => [10.00, -84.00],
            'CS' => [44.8, 20.5],
            'CU' => [21.50, -80.00],
            'CV' => [16.00, -24.00],
            'CX' => [-10.50, 105.67],
            'CY' => [35.00, 33.00],
            'CZ' => [49.75, 15.00],
            'DE' => [51.50, 10.50],
            'DJ' => [11.50, 42.50],
            'DK' => [56.00, 10.00],
            'DM' => [15.50, -61.33],
            'DO' => [19.00, -70.67],
            'DZ' => [28.00, 3.00],
            'EC' => [-2.00, -77.50],
            'EE' => [59.00, 26.00],
            'EG' => [27.00, 30.00],
            'EH' => [23.00, -14.00],
            'ER' => [15.00, 39.00],
            'ES' => [40.00, -4.00],
            'ET' => [8.00, 39.00],
            'FI' => [64.00, 26.00],
            'FJ' => [-18.00, 178.00],
            'FK' => [-51.75, -59.00],
            'FM' => [5.00, 152.00],
            'FO' => [62.00, -7.00],
            'FR' => [46.00, 2.00],
            'FX' => [48.87, 2.33],
            'GA' => [-1.00, 11.75],
            'GB' => [54.00, -4.50],
            'GD' => [12.12, -61.67],
            'GE' => [42.00, 43.50],
            'GF' => [4.00, -53.00],
            'GG' => [49.45, -2.55],
            'GH' => [8.00, -2.00],
            'GI' => [36.13, -5.35],
            'GL' => [72.00, -40.00],
            'GM' => [13.50, -15.50],
            'GN' => [11.00, -10.00],
            'GP' => [16.25, -61.58],
            'GQ' => [2.00, 10.00],
            'GR' => [39.00, 22.00],
            'GS' => [-54.50, -37.00],
            'GT' => [15.50, -90.25],
            'GU' => [13.47, 144.83],
            'GW' => [12.00, -15.00],
            'GY' => [5.00, -59.00],
            'HK' => [22.25, 114.17],
            'HM' => [-53.10, 73.52],
            'HN' => [15.00, -86.50],
            'HR' => [45.17, 15.50],
            'HT' => [19.00, -72.42],
            'HU' => [47.00, 20.00],
            'ID' => [-5.00, 120.00],
            'IE' => [53.00, -8.00],
            'IL' => [31.50, 34.75],
            'IM' => [54.23, -4.55],
            'IN' => [20.00, 77.00],
            'IO' => [-6.00, 71.50],
            'IQ' => [33.00, 44.00],
            'IR' => [32.00, 53.00],
            'IS' => [65.00, -18.00],
            'IT' => [42.83, 12.83],
            'JE' => [49.19, -2.11],
            'JM' => [18.25, -77.50],
            'JO' => [31.00, 36.00],
            'JP' => [36.00, 138.00],
            'KE' => [1.00, 38.00],
            'KG' => [41.00, 75.00],
            'KH' => [13.00, 105.00],
            'KI' => [-5.00, -170.00],
            'KM' => [-12.17, 44.25],
            'KN' => [17.33, -62.75],
            'KP' => [40.00, 127.00],
            'KR' => [37.00, 127.50],
            'KW' => [29.50, 47.75],
            'KY' => [19.50, -80.67],
            'KZ' => [48.00, 68.00],
            'LA' => [18.00, 105.00],
            'LB' => [33.83, 35.83],
            'LC' => [13.88, -60.97],
            'LI' => [47.17, 9.53],
            'LK' => [7.00, 81.00],
            'LR' => [6.50, -9.50],
            'LS' => [-29.50, 28.25],
            'LT' => [56.00, 24.00],
            'LU' => [49.75, 6.17],
            'LV' => [57.00, 25.00],
            'LY' => [25.00, 17.00],
            'MA' => [32.00, -5.00],
            'MC' => [43.73, 7.42],
            'MD' => [47.00, 29.00],
            'ME' => [42.80, 19.20],
            'MG' => [-20.00, 47.00],
            'MH' => [11.00, 168.00],
            'MK' => [41.83, 22.00],
            'ML' => [17.00, -4.00],
            'MM' => [22.00, 98.00],
            'MN' => [46.00, 105.00],
            'MO' => [22.00, 113.00],
            'MP' => [15.12, 145.67],
            'MQ' => [14.67, -61.00],
            'MR' => [20.00, -12.00],
            'MS' => [16.75, -62.20],
            'MT' => [35.92, 14.42],
            'MU' => [-20.30, 57.58],
            'MV' => [3.20, 73.00],
            'MW' => [-13.50, 34.00],
            'MX' => [23.00, -102.00],
            'MY' => [4.22, 101.97],
            'MZ' => [-18.25, 35.00],
            'NA' => [-22.00, 17.00],
            'NC' => [-21.50, 165.50],
            'NE' => [16.00, 8.00],
            'NF' => [-29.08, 167.92],
            'NG' => [10.00, 8.00],
            'NI' => [13.00, -85.00],
            'NL' => [52.50, 5.75],
            'NO' => [62.00, 10.00],
            'NP' => [28.00, 84.00],
            'NR' => [-0.53, 166.92],
            'NU' => [-19.03, -169.87],
            'NZ' => [-42.00, 174.00],
            'OM' => [21.00, 57.00],
            'PA' => [9.00, -80.00],
            'PE' => [-10.00, -76.00],
            'PF' => [-15.00, -140.00],
            'PG' => [-6.00, 147.00],
            'PH' => [13.00, 122.00],
            'PK' => [30.00, 70.00],
            'PL' => [52.00, 20.00],
            'PM' => [46.83, -56.33],
            'PN' => [-25.07, -130.08],
            'PR' => [18.23, -66.55],
            'PS' => [32.0000, 35.2500],
            'PT' => [39.50, -8.00],
            'PW' => [6.00, 134.00],
            'PY' => [-23.00, -58.00],
            'QA' => [25.50, 51.25],
            'RE' => [-21.10, 55.60],
            'RO' => [46.00, 25.00],
            'RS' => [43.80, 21.00],
            'RU' => [60.00, 47.00],
            'RW' => [-2.00, 30.00],
            'SA' => [25.00, 45.00],
            'SB' => [-8.00, 159.00],
            'SC' => [-4.58, 55.67],
            'SD' => [15.00, 30.00],
            'SE' => [62.00, 15.00],
            'SG' => [1.37, 103.80],
            'SH' => [-15.95, -5.70],
            'SI' => [46.25, 15.17],
            'SJ' => [78.00, 20.00],
            'SK' => [48.67, 19.50],
            'SL' => [8.50, -11.50],
            'SM' => [43.93, 12.42],
            'SN' => [14.00, -14.00],
            'SO' => [6.00, 48.00],
            'SR' => [4.00, -56.00],
            'ST' => [1.00, 7.00],
            'SU' => [60.00, 47.00],
            'SV' => [13.83, -88.92],
            'SY' => [35.00, 38.00],
            'SZ' => [-26.50, 31.50],
            'TC' => [21.73, -71.58],
            'TD' => [15.00, 19.00],
            'TF' => [-43.00, 67.00],
            'TG' => [8.00, 1.17],
            'TH' => [15.00, 100.00],
            'TJ' => [39.00, 71.00],
            'TK' => [-9.00, -171.75],
            'TL' => [-8.87, 125.72],
            'TM' => [40.00, 60.00],
            'TN' => [34.00, 9.00],
            'TO' => [-20.00, -175.00],
            'TP' => [-9.00, 125.00],
            'TR' => [39.00, 35.00],
            'TT' => [11.00, -61.00],
            'TV' => [-8.00, 178.00],
            'TW' => [23.50, 121.00],
            'TZ' => [-6.00, 35.00],
            'UA' => [49.00, 32.00],
            'UG' => [2.00, 33.00],
            'UM' => [10.00, -175.00],
            'US' => [38.00, -98.00],
            'UY' => [-33.00, -56.00],
            'UZ' => [41.00, 64.00],
            'VA' => [41.90, 12.45],
            'VC' => [13.08, -61.20],
            'VE' => [8.00, -66.00],
            'VG' => [18.50, -64.50],
            'VI' => [18.50, -64.43],
            'VN' => [16.00, 106.00],
            'VU' => [-16.00, 167.00],
            'WF' => [-14.00, -177.00],
            'WS' => [-13.58, -172.33],
            'YE' => [15.50, 47.50],
            'YT' => [-12.83, 45.17],
            'YU' => [44.00, 21.00],
            'ZA' => [-30.00, 26.00],
            'ZM' => [-15.00, 30.00],
            'ZR' => [-1.00, 22.00],
            'ZW' => [-19.00, 29.00],
        ];

        $eventsWithoutGeolocation = Event::where('geoposition', '=', '0,0')->get();

        foreach ($eventsWithoutGeolocation as $event) {

            $geoposition = $COUNTRY_LAT_LANG[$event->country_iso];

            $event->geoposition = $geoposition[0].','.$geoposition[1];
            $event->latitude = $geoposition[0];
            $event->longitude = $geoposition[1];
            $event->save();
        }

    }
}
